function SingleChoiceBox(a,d){if(d==null)d=[];var strIconPath="Icon/",r=null,n=false,t=false,s=false,e=null,m="";this.setEmptyValue=function(a){m=a};var f="id",c="name",g="children",b="";b+="<div id='"+a+"' style='position: absolute; z-index: 999999; background-color:#FFFFFF ;overflow:auto;width: 300; height: 300; display: none'>";b+='<table rules="all" cellspacing="0" style="border:1px solid #575757">';b+="<tr>";b+='<td style="border:0px">';b+="<iframe id='"+a+"IFrame' scrolling='yes' frameborder='0' width='100%' height='260'></iframe>";b+="</td>";b+="</tr>";b+="<tr>";b+='<td style="border-width:1px 0px 0px 0px">';b+='<table width="100%" cellspacing="0" cellpadding="0" style="margin:0px;padding:0px">';b+="<tr>";b+='<td id="tdClear" align="center"><input id="inputClear" type="button" value="清除" onclick="document.getElementById(\''+a+"').objThis.onClear()\"/></td>";b+='<td id="tdOK" align="center"><input id="inputOK" type="button" value="确定" onclick="document.getElementById(\''+a+"').objThis.onOK()\"/></td>";b+='<td id="tdClose" align="center"><input id="inputClose" type="button" value="关闭" onclick="document.getElementById(\''+a+"').objThis.onClose()\"/></td>";b+="</tr>";b+="</table>";b+="</td>";b+="</tr>";b+="</table>";b+="</div>";document.writeln(b);document.getElementById(a).objThis=this;var selectedElement=null,selectedNodeId="",i="",h="";this.getIconPath=function(){return strIconPath};this.setIconPath=function(a){strIconPath=a};this.setVarName=function(d,b,a){f=d;c=b;g=a};this.reinit=function(a){selectedElement=null;selectedNodeId="";i="";h="";d=a};this.show=function(j,r,l){var t=200,c=200;if(r!=null||r==undefined)t=r;if(l!=null||l==undefined)c=l;document.getElementById(a).style.width=t+"px";document.getElementById(a).style.height=c+"px";document.getElementById(a+"IFrame").style.height=c-40+"px";var g=event.srcElement;e=g;selectedNodeId=e.getAttribute("selectedId");i=e.getAttribute("selectedName");h=e.value;if(j!=null&&j!=undefined)n=j;selectedElement=null;var b="";b+="<html>";b+="<head><meta http-equiv='Content-Type' content='text/html; charset=utf-8'></head>";b+="<body onkeydown='return false' onselectstart='return false' style='margin: 0px' oncontextmenu='return false'>";b+=o(d,1,0,selectedNodeId,n);b+="</body>";b+="</html>";var m=document.getElementById(a+"IFrame");m.contentWindow.document.writeln(b);m.contentWindow.document.close();if(selectedNodeId!="")with(m.contentWindow){for(var tds=document.firstChild.children[1].firstChild.getElementsByTagName("td"),i=0;i<tds.length;i++){if(tds.item(i).tagName.toLowerCase()!="td")continue;if(tds.item(i).getAttribute("value")==null||tds.item(i).getAttribute("value")==""||tds.item(i).getAttribute("value")==undefined)continue;if(tds.item(i).getAttribute("value")==selectedNodeId){selectedElement=tds.item(i).previousSibling.children[0];break}}if(selectedElement!=null){var trNode=selectedElement.parentNode.parentNode;while(trNode.parentNode.parentNode.parentNode.tagName.toLowerCase()!="body"){trNode.parentNode.parentNode.parentNode.parentNode.setAttribute("childflag","2");trNode.parentNode.parentNode.parentNode.parentNode.style.display="inline-block";trNode.parentNode.parentNode.parentNode.parentNode.style.width="10px";trNode.parentNode.parentNode.parentNode.parentNode.previousSibling.firstChild.firstChild.src=strIconPath+"OpenCross.png";trNode=trNode.parentNode.parentNode.parentNode.parentNode}}}var u=p(g),f=0,k=q(g);f=k+g.offsetHeight;if(k>=c&&f+c>document.body.offsetHeight)f=k-c;var s=document.getElementById(a);s.style.posLeft=u;s.style.posTop=f;s.style.display="block";document.getElementById(a+"IFrame").focus();document.onclick=function(){if(event.srcElement==e)return;document.getElementById(a).objThis.onClose()};document.getElementById(a).onclick=function(){var a=window.event||arguments[0];if(document.all)a.cancelBubble=true;else a.stopPropagation()}};this.onOpenClose=function(){var b=document.getElementById(a+"IFrame").contentWindow.event.srcElement;if(b.getAttribute("childflag")!="0")if(b.getAttribute("childflag")=="1"){b.parentNode.parentNode.nextSibling.style.display="block";b.parentNode.parentNode.nextSibling.style.width="10px";if(b.getAttribute("lastchildflag")==0)b.src=strIconPath+"OpenCross.png";else b.src=strIconPath+"LOpenCross.png";b.setAttribute("childflag","2")}else{b.parentNode.parentNode.nextSibling.style.display="none";if(b.getAttribute("lastchildflag")==0)b.src=strIconPath+"CloseCross.png";else b.src=strIconPath+"LCloseCross.png";b.setAttribute("childflag","1")}};this.onSelect=function(){var b=document.getElementById(a+"IFrame").contentWindow.event.srcElement;if(b.tagName.toLowerCase()=="nobr")b=b.parentNode.previousSibling.children[0];else if(b.tagName.toLowerCase()=="td")b=b.previousSibling.children[0];else b.tagName.toLowerCase()=="img";b.getAttribute("selectflag")=="0";if(b.getAttribute("selectflag")=="1"){if(selectedElement!=null){selectedElement.src=strIconPath+"Unselected.gif";selectedElement.setAttribute("selectflag","1");selectedElement.parentNode.nextSibling.style.color="#000000"}b.src=strIconPath+"Selected.gif";b.setAttribute("selectflag","2");b.parentNode.nextSibling.style.color="#FF0000";selectedElement=b;i=selectedElement.parentNode.nextSibling.firstChild.innerText;selectedNodeId=selectedElement.parentNode.nextSibling.getAttribute("value");h=selectedElement.parentNode.nextSibling.firstChild.getAttribute("path")}};this.onClear=function(){if(selectedElement==null||selectedElement==undefined)return;try{selectedElement.src=strIconPath+"Unselected.gif";selectedElement.setAttribute("selectflag","1");selectedElement.parentNode.nextSibling.style.color="#000000"}catch(a){}selectedElement=null;selectedNodeId="";i="";h=""};this.onOK=function(){if(selectedElement!=null)h=selectedElement.parentNode.nextSibling.firstChild.getAttribute("path");document.getElementById(a).style.display="none";e.setAttribute("selectedId",selectedNodeId);e.setAttribute("selectedName",i);if(selectedNodeId!="")e.value=h;else e.value=m;e.onchange!=undefined&&e.onchange!=null&&e.onchange()};this.onClose=function(){document.getElementById(a).style.display="none"};var p=function(a){if(a.offsetParent==null)return a.offsetLeft;else{var b=p(a.offsetParent);return a.offsetLeft+b}},q=function(a){if(a.offsetParent==null)return a.offsetTop;else{var b=q(a.offsetParent);return a.offsetTop+b}},o=function(f,d,g,c,e,a){if(a==null||a==undefined||a=="")a="";else a+=">";var b="";b+='<table style="font-size:9pt;padding:0;" cellpadding="0" cellspacing="0">';b+=l(f,d,g,c,e,a);b+="</table>";return b},l=function(i,j,m,h,k,e){var b="";if(i.constructor!=window.Array){var n=eval("treeNode."+g);if(n==null||n.length==0){b+="<tr>";if(m+1<j)b+='<td style="width:20px; "><img src="'+strIconPath+'TConnector.png" onclick="parent.document.getElementById(\''+a+'\').objThis.onOpenClose()" childflag="0"></td>';else b+='<td><img src="'+strIconPath+'LConnector.png" onclick="parent.document.getElementById(\''+a+'\').objThis.onOpenClose()" childflag="0"></td>';if(h!=eval("treeNode."+f)){b+='<td style="cursor:default"><img src="'+strIconPath+'Unselected.gif" onclick="parent.document.getElementById(\''+a+'\').objThis.onSelect()" selectflag="1"></td>';b+='<td style="cursor:default" value="'+eval("treeNode."+f)+'" onclick="parent.document.getElementById(\''+a+'\').objThis.onSelect()"><nobr path="'+e+eval("treeNode."+c)+'">'+eval("treeNode."+c)+"</nobr></td>"}else{b+='<td style="cursor:default"><img src="'+strIconPath+'Selected.gif" onclick="parent.document.getElementById(\''+a+'\').objThis.onSelect()" selectflag="2"></td>';b+='<td style="cursor:default;color:#FF0000" value="'+eval("treeNode."+f)+'" onclick="parent.document.getElementById(\''+a+'\').objThis.onSelect()"><nobr path="'+e+eval("treeNode."+c)+'">'+eval("treeNode."+c)+"</nobr></td>"}b+="</tr>";return b}else{b+="<tr>";if(m+1<j)b+='<td><img src="'+strIconPath+'CloseCross.png" onclick="parent.document.getElementById(\''+a+'\').objThis.onOpenClose()" childflag="1" lastchildflag="0"></td>';else b+='<td><img src="'+strIconPath+'LCloseCross.png" onclick="parent.document.getElementById(\''+a+'\').objThis.onOpenClose()" childflag="1" lastchildflag="1"></td>';if(k==false)if(h!=eval("treeNode."+f)){b+='<td style="cursor:default"><img src="'+strIconPath+'Unselected.gif" onclick="parent.document.getElementById(\''+a+'\').objThis.onSelect()" selectflag="1"></td>';b+='<td style="cursor:default" value="'+eval("treeNode."+f)+'" onclick="parent.document.getElementById(\''+a+'\').objThis.onSelect()"><nobr path="'+e+eval("treeNode."+c)+'">'+eval("treeNode."+c)+"</nobr></td>"}else{b+='<td style="cursor:default"><img src="'+strIconPath+'Selected.gif" onclick="parent.document.getElementById(\''+a+'\').objThis.onSelect()" selectflag="2"></td>';b+='<td style="cursor:default;color:#FF0000" value="'+eval("treeNode."+f)+'" onclick="parent.document.getElementById(\''+a+'\').objThis.onSelect()"><nobr path="'+e+eval("treeNode."+c)+'">'+eval("treeNode."+c)+"</nobr></td>"}else{b+='<td><img src="'+strIconPath+'Connector.png"></td>';b+='<td><nobr path="'+e+eval("treeNode."+c)+'">'+eval("treeNode."+c)+"</nobr></td>"}b+="</tr>";b+="<tr style='display:none'>";if(m+1<j)b+="<td style=\"background-image:url('"+strIconPath+"IConnector.png')\"></td>";else b+="<td></td>";b+="<td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>";b+="<td>";for(var d=0;d<(eval("treeNode."+g)).length;d++){var p=(eval("treeNode."+g))[d];b+=o((eval("treeNode."+g))[d],(eval("treeNode."+g)).length,d,h,k,e+eval("treeNode."+c))}b+="</td>";b+="</tr>"}}else for(var d=0;d<i.length;d++)b+=l(i[d],i.length,d,h,k,e);return b},j=function(i,e){var h="",b=eval("treeNode."+f);if(b==e)return b;var a=eval("treeNode."+g);if(a==undefined)return null;for(var c=0;c<a.length;c++){var d=j(a[c],e);if(d!=null)return b+"."+d}return null},k=function(e,d){var b=eval("nodeParent."+g);if(b==undefined||b==null)return null;for(var a=null,c=0;c<b.length;c++){if(eval("children[i]."+f)==d){a=e;break}a=k(b[c],d);if(a!=null)break}return a};this.getParent=function(b){if(d.constructor==window.Array){for(var a=null,c=0;c<d.length;c++){if(eval("jsonData[i]."+f)==b)break;a=k(d[c],b);if(a!=null)break}return a}else return k(d,b)};this.getNodeIdPath=function(e){var a="";if(d.constructor!=window.Array)a+=j(d,e);else for(var b=0;b<d.length;b++){var c=j(d[b],e);if(c!=null){a+=c;break}}return a==null?null:a.split(".")}}